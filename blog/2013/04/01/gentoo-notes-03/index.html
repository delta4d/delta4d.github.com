
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>gentoo notes 03 - programs - Try To Think</title>
  <meta name="author" content="delta">

  
  <meta name="description" content="稍微总结下gentoo下常用的一些软件。 Emerge emerge是使用portage的一个工具。 查询emerge相关选项的含义 $ man emerge 更新portage树 # 使用rsnyc
$ emerge --sync
# rsync不能用时，使用gentoo每天的portage快照 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://delta4d.github.io/blog/2013/04/01/gentoo-notes-03">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Try To Think" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
<head>
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-36393620-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Try To Think</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:delta4d.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/aboutme">AboutMe</a></li>
  <li><a href="/x">X</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Gentoo Notes 03 - Programs</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-01T21:45:00+08:00" pubdate data-updated="true">Apr 1<span>st</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>稍微总结下gentoo下常用的一些软件。</p>

<h2 id="emerge">Emerge</h2>

<blockquote>
  <p>emerge是使用<a href="http://en.wikipedia.org/wiki/Portage_(software)">portage</a>的一个工具。</p>
</blockquote>

<ul>
  <li>
    <p>查询emerge相关选项的含义</p>

    <pre><code>$ man emerge
</code></pre>
  </li>
  <li>
    <p>更新portage树</p>

    <pre><code># 使用rsnyc
$ emerge --sync
# rsync不能用时，使用gentoo每天的portage快照
$ emerge-webrsync
</code></pre>
  </li>
  <li>
    <p>查询软件</p>

    <pre><code># 搜索所有名字里包含pdf的包
$ emerge --search pdf
# 在包描述里查询关键字
$ emerge --searchdesc pdf
# 或
$ emerge -S pdf
</code></pre>

    <p>当然还有更好更快的方法，这个在后面会提到。</p>
  </li>
  <li>
    <p>安装软件</p>

    <pre><code># 安装gnumeric
$ emerge gunmeric
# 假装安装软件。在你不确定这个软件都要装哪些包时，可以用这个命令
$ emerge --pretend gnumeric
# 只下载源码，可在/usr/portage/distfiles目录下找到
$ emerge --fetchonly gnumeric
</code></pre>
  </li>
  <li>
    <p>查找已安装包文档</p>

    <p>doc USE决定了包文档是否被安装</p>

    <pre><code># 以alsa-lib为例
$ emerge -vp alsa-lib
[ebuild  N    ] media-libs/alsa-lib-1.0.14_rc1  -debug +doc 698 kB
</code></pre>

    <p>后面会提到有更好的工具。</p>
  </li>
  <li>
    <p>删除软件</p>

    <pre><code># 删除gnumeric
$ emerge -unmerge gnumeric
</code></pre>
  </li>
  <li>
    <p>更新系统</p>

    <pre><code># 更新系统
$ emerge --update --ask world
# 更新依赖。否则只会更新列在/var/lib/portage/world里的软件
$ emerge --update --deep world
# 上面的命令还是没有更新全部包，因为在装某个软件时，只有在编译时依赖，而在编译完后就不再需要了。
$ emerge --update --deep --with-bdeps=y world # bdeps = build dependencies
# 如果USE标记有改变
$ emerge --update --deep --with-bdeps=y --newuse world

# 更新整个系统的话，一般执行以下的命令
$ emerge --sync
$ emerge -avuND world
$ revdep-rebuild # from gentoolkit
</code></pre>
  </li>
  <li>
    <p>一些标记</p>

    <p>更新系统或装软件时经常会看到一些字母，或者不同的颜色，这些都是有自己特定的意义的</p>

    <p><strong>State flags</strong></p>

    <pre><code>B 被已安装的包拦截（阻挡？block怎么翻译比较好= =）
b 被已安装的包拦截（但是冲突会自动解决）
I 交互式包安装（需要用户输入）
N 新的包，未安装
S 安装到一个新的slot（怎么翻。。）
D 降级到一个老版本（downgrade）
U 升级到一个新版本（upgrage）
R 重新安装相同的版本，很可能时由于新的USE标记或有标记被移除
F 下载受限，必须手动下载（比如oracle java诶，要点I agree啊。。）
f 已经下载过啦（nothing to do，yay）
r 重新安装（很可能是slot或sub-slot的问题）
</code></pre>

    <p><strong>USE flags</strong></p>

    <pre><code>未被高亮的USE是不变或启用
USE（黄绿蓝）前的减号（-）表示该标记被禁用
USE后的百分号（%）标志着新加入或被移除，和yellow一样
USE后的星号（*）表示它的意义/域有所改变，和green一样
USE两侧的括号()表示它当前被屏蔽（可能由于当前的平台不支持此标记）
</code></pre>

    <p><strong>Color</strong></p>

    <pre><code>red USE被启用或不变
yellow USE被添加，移除或屏蔽
green USE自从上次安装后被改变了，和（*）已一样
blue USE被禁用，和减号（-）一样
</code></pre>
  </li>
  <li>
    <p>安装软件again</p>

    <p>不能成功安装时请仔细查看emerge输出，添加相应的内容到/etc/portage/的package.keywords,package.license,package.mask,package.unmask,package.use等文件。</p>
  </li>
</ul>

<h2 id="gentoolkit">Gentoolkit</h2>

<blockquote>
  <p>这是其他发行版不存在的一个工具，可以说它在一定程度上代表了Gentoo，位于app-portage/gentoolkit。看到kit应该就知道了，这其实是一个工具包，而不是一个单一的软件。接下来一个一个介绍。</p>
</blockquote>

<ul>
  <li>
    <p>安装</p>

    <pre><code>emerge gentoolkit
</code></pre>
  </li>
  <li>
    <p>equery</p>

    <p>equery用来显示系统上包的信息。可以使用<code>equery --help</code>列出相关选项，更详细的可以<code>man equery</code></p>

    <pre><code># 查找一个文件来自哪个包
$ equery belongs /usr/bin/xmms
[ Searching for file(s) /usr/bin/xmms in *... ]
media-sound/xmms-1.2.10-r9 (/usr/bin/xmms)
# 使用-f，可以使用正则表达式，使用-e可以在找到一个匹配后立刻终止
	
# 检查包的完整性
# 检查md5和时间戳来检查一个可能被冲突，替换或移除的包
$ equery check gentoolkit
[ Checking app-portage/gentoolkit-0.2.0 ]
 * 54 out of 54 files good
# 配置文件改变可能被认为not good

# 依赖
# equery可以用来查询一个包的直接依赖
$ equery depends pygtk
[ Searching for packages depending on pygtk... ]
app-office/dia-0.93
dev-python/gnome-python-2.0.0-r1
gnome-extra/gdesklets-core-0.26.2
media-gfx/gimp-2.0.4
x11-libs/vte-0.11.11-r1
# equery可以查询一个特定包的依赖图
$ equery depgraph cdrtools

# 查询属于一个ebuild的文件
$ equery files gentookit

# 查找使用特定USE标记的包
$ equery hasuse mozilla

# 列出包
$ equery list gentoolkit

# 计算包大小
$ equery size openoffice-bin

# 特定包的USE
$ equery uses ethereal

# 查找ebuild位置
$ equery which cdrtools
</code></pre>
  </li>
  <li>
    <p>euse</p>

    <p>euse用来列出，启用或禁用USE标记。</p>

    <pre><code># 获取当前活动的USE标记
$ euse -a

# 启用USE标记
$ euse -E 3dfx # /etc/make.conf会被改变，备份为/etc/make.conf.euse_backup

# 禁用USE标记
$ euse -D 3dfx
</code></pre>
  </li>
  <li>
    <p>glsa-check</p>

    <p>glsa-check主要用来跟踪GLSA’s（Gentoo Linux Security Advisory）。</p>

    <pre><code># 列出未被应用的GLSAs
$ glsa-check --list

# 特定GLSAs的信息
$ glsa-check --dump 200812-20

# 测试特定GLSAs的易碎性
$ glsa-check --test 200812-20

# 自动应用GLSAs
$ glsa-check --fix 200901-15
</code></pre>
  </li>
  <li>
    <p>revdep-rebuild</p>

    <p>Gentoo的一个反向依赖重建工具。经常在系统更新完后运行此命令。</p>

    <pre><code># pretend mode
$ revdep-rebuild -p
# normal mode
$ revdep-rebuild
</code></pre>
  </li>
  <li>
    <p>eread</p>

    <p>显示portage的elog文件。可以在makefile里设置保存的elog文件的相关变量。</p>

    <pre><code># file location: /etc/make.conf
PORTAGE_ELOG_GLASSES="log"
PORTAGE_ELOG_SYSTEM="save"
</code></pre>

    <p>一旦设置好后，运行<code>eread</code>就可以了。</p>
  </li>
  <li>
    <p>eclean</p>

    <p>eclean用来移除陈旧的源码和二进制文件。</p>
  </li>
</ul>

<h2 id="portage-utils">Portage-utils</h2>

<blockquote>
  <p>Portage-utils提供了一组快速的工具，但是相对gentoolkit在功能上有所限制，这也是由于追求速度所牺牲的。</p>
</blockquote>

<ul>
  <li>
    <p>安装</p>

    <pre><code>emerge portage-utils
</code></pre>
  </li>
  <li>
    <p>使用</p>

    <pre><code># qfile找到一个文件属于哪个包
$ qfile /etc/fonts/fonts.conf

# qcheck检查包的完整性
$ qcheck portage-utils

# qdepends列出包依赖
$ qdepends -a pygtk

# qlist列出属于某个ebuild的文件
$ qlist vim

# quse查找包的USE标记
$ quse firefox

# qsize查询包大小
$ qsize vim

# qsearch查找portage树
$ qsearch terminus
$ qsearch -H terminus # terminus作者的主页是啥？
$ qsearch -S "jabber client" # 需要一个jabber clinet？

# qlop查询emerge log信息
$ qlop -tH perl # 装perl大概要多长时间
$ qlop -c # 看看emerge现在在干什么^_^
</code></pre>
  </li>
</ul>

<h2 id="eix">Eix</h2>

<blockquote>
  <p>快速查找portage树。我现在基本都用eix来查找。</p>
</blockquote>

<ul>
  <li>
    <p>安装</p>

    <pre><code>emerge eix
</code></pre>
  </li>
  <li>
    <p>更新缓存</p>

    <pre><code>$ eix-update
$ eix-sync # will run emerge --sync first
</code></pre>
  </li>
  <li>
    <p>使用</p>

    <pre><code>$ eix --help
$ eix emer # 查询名字里有emer的包
$ eix -C app-portage emer # 在给定类型里查找
$ eix -I -C app-portage porta # 查询已安装的包
$ eix -S description # 查找包描述
$ eix -S -c corba # 查找包描述并且打印完整的列表
$ eix-remote update # 更新overlay缓存
$ eix-test-obsolete -c -b # 陈旧和遗失包查询
</code></pre>
  </li>
</ul>

<h2 id="layman">Layman</h2>

<blockquote>
  <p>用来管理overlays的工具。</p>
</blockquote>

<ul>
  <li>
    <p>安装</p>

    <pre><code>emerge layman
</code></pre>
  </li>
  <li>
    <p>配置</p>

    <pre><code>(for layman 1.1)
$ echo "source /usr/portage/local/layman/make.conf" &gt;&gt; /etc/make.conf

(for layman 1.2)
$ echo "source /usr/local/portage/layman/make.conf" &gt;&gt; /etc/make.conf

(for layman 1.3 and later)
$ echo "source /var/lib/layman/make.conf" &gt;&gt; /etc/make.conf
</code></pre>
  </li>
  <li>
    <p>使用</p>

    <pre><code># 列出可用overlays
$ layman -L

# 安装一个overlay
$ layman -a &lt;overlay-name&gt;

# 更新overlay
$ layman -S
</code></pre>
  </li>
</ul>

<h2 id="references">References</h2>

<ul>
  <li><a href="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=1">A Portage Introduction</a></li>
  <li><a href="http://en.wikipedia.org/wiki/Portage_(software)">Gentoo Portage Wiki</a>	</li>
  <li><a href="http://en.wikipedia.org/wiki/Portage_(software)">Portage Wikipedia</a></li>
  <li><a href="http://www.gentoo.org/doc/en/gentoolkit.xml">Gentoolkit</a></li>
  <li><a href="http://www.gentoo.org/doc/en/portage-utils.xml">Portage-Utils</a></li>
  <li><a href="http://eix.berlios.de/">Eix Homepage</a></li>
  <li><a href="http://www.gentoo.org/proj/en/overlays/userguide.xml">Gentoo Overlays</a></li>
</ul>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">delta</span></span>

      








  


<time datetime="2013-04-01T21:45:00+08:00" pubdate data-updated="true">Apr 1<span>st</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/gentoo/'>gentoo</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://delta4d.github.io/blog/2013/04/01/gentoo-notes-03/" data-via="" data-counturl="http://delta4d.github.io/blog/2013/04/01/gentoo-notes-03/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/03/23/codeforces-round-number-176-div-1/" title="Previous Post: Codeforces Round #176 (Div. 1)">&laquo; Codeforces Round #176 (Div. 1)</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/04/03/codeforces-round-number-177-div-1/" title="Next Post: Codeforces Round #177 (Div. 1)">Codeforces Round #177 (Div. 1) &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/11/13/wind/">wind</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/31/funtoo-on-vbox/">funtoo on vbox</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/29/codeforces-round-number-190-div-1/">Codeforces Round #190 (Div. 1)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/08/codeforces-round-number-187-div-1/">Codeforces Round #187 (Div. 1)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/27/an-useful-congruence-identitie/">An Useful Congruence Identity</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/delta4d">@delta4d</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'delta4d',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - delta -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'delta4d';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://delta4d.github.io/blog/2013/04/01/gentoo-notes-03/';
        var disqus_url = 'http://delta4d.github.io/blog/2013/04/01/gentoo-notes-03/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
